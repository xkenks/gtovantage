"use strict";(()=>{var e={};e.id=421,e.ids=[421],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},4017:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>N,patchFetch:()=>O,requestAsyncStorage:()=>k,routeModule:()=>C,serverHooks:()=>T,staticGenerationAsyncStorage:()=>S});var n={};s.r(n),s.d(n,{DELETE:()=>F,GET:()=>f,PATCH:()=>v,POST:()=>R});var r=s(9303),o=s(8716),a=s(670),u=s(7070),l=s(2048),c=s.n(l),i=s(5315),g=s.n(i),p=s(1482),d=s.n(p);let m=null,h=null,y="/tmp",x=g().join(y,"mtt-ranges.json"),j=process.env.JWT_SECRET||"gto-vantage-admin-secret-key-2024";function D(e){try{let t=e.headers.get("authorization");if(!t||!t.startsWith("Bearer "))return!1;let s=t.substring(7),n=d().verify(s,j);return"admin"===n.role}catch(e){return!1}}async function f(e){console.log("\uD83C\uDFAF GET /api/mtt-ranges é–‹å§‹");try{if(m&&h)return console.log("\uD83C\uDFAF ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’è¿”å´:",{lastUpdated:h,totalPositions:m.metadata.totalPositions,totalHands:m.metadata.totalHands,hasRanges:!!m.ranges,rangesCount:m.ranges?Object.keys(m.ranges).length:0}),u.NextResponse.json(m);if(!c().existsSync(x)){console.log("\uD83C\uDFAF ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ç©ºã®ãƒ‡ãƒ¼ã‚¿ã‚’è¿”å´");let e={version:"1.0.0",lastUpdated:new Date().toISOString(),ranges:{},metadata:{totalPositions:0,totalHands:0,creator:"System",environment:"production"}};return u.NextResponse.json(e)}console.log("\uD83C\uDFAF ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿é–‹å§‹");let e=c().readFileSync(x,"utf8"),t=JSON.parse(e);return m=t,h=t.lastUpdated,console.log("\uD83C\uDFAF ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ›´æ–°:",{lastUpdated:h,totalPositions:t.metadata.totalPositions,totalHands:t.metadata.totalHands,hasRanges:!!t.ranges,rangesCount:t.ranges?Object.keys(t.ranges).length:0,fileSize:e.length}),u.NextResponse.json(t)}catch(e){return console.error("MTTãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",e),u.NextResponse.json({error:"ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ"},{status:500})}}async function R(e){if(console.log("\uD83C\uDFAF POST /api/mtt-ranges é–‹å§‹"),!D(e))return console.log("âŒ ç®¡ç†è€…èªè¨¼å¤±æ•—"),u.NextResponse.json({error:"ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™"},{status:403});console.log("âœ… ç®¡ç†è€…èªè¨¼æˆåŠŸ");try{let{ranges:t,metadata:s}=await e.json();if(console.log("\uD83C\uDFAF ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:",{hasRanges:!!t,rangesType:typeof t,rangesKeys:t?Object.keys(t):[],rangesCount:t?Object.keys(t).length:0,metadata:s}),!t||"object"!=typeof t)return console.log("âŒ ç„¡åŠ¹ãªãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¼ã‚¿"),u.NextResponse.json({error:"ç„¡åŠ¹ãªãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¼ã‚¿ã§ã™"},{status:400});let n=Object.keys(t).length,r=Object.values(t).reduce((e,t)=>e+Object.keys(t).length,0),o={version:"1.0.0",lastUpdated:new Date().toISOString(),ranges:t,metadata:{totalPositions:n,totalHands:r,creator:s?.creator||"Admin",environment:"production"}};return console.log("\uD83C\uDFAF Vercelç’°å¢ƒ: ãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ›´æ–°"),m=o,h=o.lastUpdated,console.log(`ðŸ”’ ç®¡ç†è€…ãŒMTTãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ï¼ˆãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°ï¼‰: ${n}ãƒã‚¸ã‚·ãƒ§ãƒ³, ${r}ãƒãƒ³ãƒ‰`),console.log("\uD83C\uDFAF ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°è©³ç´°:",{hasCache:!!m,lastUpdated:h,hasRanges:!!m.ranges,rangesCount:m.ranges?Object.keys(m.ranges).length:0,rangesKeys:m.ranges?Object.keys(m.ranges).slice(0,5):[]}),u.NextResponse.json({success:!0,message:"ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã«ãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼ˆãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°ï¼‰",metadata:o.metadata,note:"ãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€Œã‚·ã‚¹ãƒ†ãƒ èª­ã¿è¾¼ã¿ã€ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã¾ã™ã€‚"})}catch(t){console.error("MTTãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",t);let e=t instanceof Error?t.message:"Unknown error";return u.NextResponse.json({error:`ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ${e}`},{status:500})}}async function F(e){if(!D(e))return u.NextResponse.json({error:"ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™"},{status:403});try{return c().existsSync(x)&&c().unlinkSync(x),m=null,h=null,console.log("\uD83D\uDD12 ç®¡ç†è€…ãŒã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼ˆãƒ•ã‚¡ã‚¤ãƒ« + ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰"),u.NextResponse.json({success:!0,message:"ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼ˆãƒ•ã‚¡ã‚¤ãƒ« + ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰"})}catch(e){return console.error("MTTãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ã‚¨ãƒ©ãƒ¼:",e),u.NextResponse.json({error:"ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ"},{status:500})}}async function v(e){if(!D(e))return u.NextResponse.json({error:"ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™"},{status:403});try{let{action:t}=await e.json();if("clear-cache"===t)return m=null,h=null,console.log("\uD83D\uDD12 ç®¡ç†è€…ãŒã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ"),u.NextResponse.json({success:!0,message:"ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ"});return u.NextResponse.json({success:!0,message:"ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®çŠ¶æ…‹",cache:{hasCache:!!m,lastUpdated:h,totalPositions:m?.metadata.totalPositions||0,totalHands:m?.metadata.totalHands||0}})}catch(e){return console.error("ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ“ä½œã‚¨ãƒ©ãƒ¼:",e),u.NextResponse.json({error:"ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ“ä½œã«å¤±æ•—ã—ã¾ã—ãŸ"},{status:500})}}c().existsSync(y)||c().mkdirSync(y,{recursive:!0});let C=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/mtt-ranges/route",pathname:"/api/mtt-ranges",filename:"route",bundlePath:"app/api/mtt-ranges/route"},resolvedPagePath:"/Users/kensuke/Desktop/gtovantage/src/app/api/mtt-ranges/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:k,staticGenerationAsyncStorage:S,serverHooks:T}=C,N="/api/mtt-ranges/route";function O(){return(0,a.patchFetch)({serverHooks:T,staticGenerationAsyncStorage:S})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),n=t.X(0,[276,972,482],()=>s(4017));module.exports=n})();