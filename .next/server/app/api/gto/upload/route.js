"use strict";(()=>{var e={};e.id=354,e.ids=[354],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},7687:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>P,patchFetch:()=>h,requestAsyncStorage:()=>k,routeModule:()=>v,serverHooks:()=>j,staticGenerationAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{GET:()=>m,POST:()=>x});var o=t(9303),n=t(8716),a=t(670),i=t(7070),u=t(8570);let p=(0,u.createProxy)(String.raw`/Users/kensuke/Desktop/gtovantage/src/lib/pioSolverParser.ts#parsePioSolverCSV`),c=(0,u.createProxy)(String.raw`/Users/kensuke/Desktop/gtovantage/src/lib/pioSolverParser.ts#extractStrategyInfoFromFilename`),l=(0,u.createProxy)(String.raw`/Users/kensuke/Desktop/gtovantage/src/lib/pioSolverParser.ts#parsePioSolverJSON`);var d=t(2048),g=t.n(d),S=t(5315),f=t.n(S);async function x(e){try{let r;let t=(await e.formData()).get("file");if(!t)return i.NextResponse.json({error:"ファイルが見つかりません"},{status:400});let s=t.name,o=f().extname(s).toLowerCase(),n=await t.arrayBuffer(),a=Buffer.from(n).toString("utf-8");if(".csv"===o){r=p(a);let e=c(s);r&&e&&(r.position=e.position,r.stackSize=e.stackSize,r.scenario=e.scenario)}else{if(".json"!==o)return i.NextResponse.json({error:"対応していないファイル形式です。CSVまたはJSONファイルをアップロードしてください。"},{status:400});r=l(a)}if(!r)return i.NextResponse.json({error:"ファイルの解析に失敗しました"},{status:400});let u=f().join(process.cwd(),"data","gto");g().mkdirSync(u,{recursive:!0});let d=`${r.position}_${r.stackSize}_${r.scenario}.json`,S=f().join(u,d);return g().writeFileSync(S,JSON.stringify(r,null,2)),i.NextResponse.json({success:!0,message:"GTOデータを正常にアップロードしました",filename:d,position:r.position,stackSize:r.stackSize,scenario:r.scenario,handCount:r.strategies.length})}catch(e){return console.error("GTOデータのアップロードに失敗しました:",e),i.NextResponse.json({error:"サーバーエラーが発生しました"},{status:500})}}async function m(){try{let e=f().join(process.cwd(),"data","gto");if(!g().existsSync(e))return g().mkdirSync(e,{recursive:!0}),i.NextResponse.json({files:[]});let r=g().readdirSync(e).filter(e=>e.endsWith(".json")).map(r=>{let t=f().join(e,r),s=g().statSync(t),o=r.match(/([A-Z]+)_(\d+BB)_(\w+)\.json/i),n="",a="",i="";return o&&o.length>=4&&(n=o[1],a=o[2],i=o[3]),{filename:r,position:n,stackSize:a,scenario:i,size:s.size,modified:s.mtime}});return i.NextResponse.json({files:r})}catch(e){return console.error("GTOデータのリスト取得に失敗しました:",e),i.NextResponse.json({error:"サーバーエラーが発生しました"},{status:500})}}let v=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/gto/upload/route",pathname:"/api/gto/upload",filename:"route",bundlePath:"app/api/gto/upload/route"},resolvedPagePath:"/Users/kensuke/Desktop/gtovantage/src/app/api/gto/upload/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:k,staticGenerationAsyncStorage:y,serverHooks:j}=v,P="/api/gto/upload/route";function h(){return(0,a.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:y})}},8570:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createProxy",{enumerable:!0,get:function(){return s}});let s=t(1749).createClientModuleProxy},1749:(e,r,t)=>{e.exports=t(3191).vendored["react-rsc"].ReactServerDOMWebpackServerEdge}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972],()=>t(7687));module.exports=s})();