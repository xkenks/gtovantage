(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{8575:function(e,t,n){Promise.resolve().then(n.t.bind(n,9974,23)),Promise.resolve().then(n.t.bind(n,2778,23)),Promise.resolve().then(n.bind(n,8133)),Promise.resolve().then(n.bind(n,8947)),Promise.resolve().then(n.bind(n,9295)),Promise.resolve().then(n.bind(n,7561)),Promise.resolve().then(n.bind(n,4362))},8133:function(e,t,n){"use strict";n.d(t,{GoogleAnalyticsScript:function(){return c},default:function(){return s}});var r=n(7437),a=n(2265),o=n(9376),i=n(4371);function s(){let e=(0,o.usePathname)();return(0,a.useEffect)(()=>{i.In&&(0,i._k)()},[]),(0,a.useEffect)(()=>{i.In&&(0,i.Z0)(e)},[e]),null}function c(){return i.In?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("script",{async:!0,src:"https://www.googletagmanager.com/gtag/js?id=".concat(i.In)}),(0,r.jsx)("script",{id:"google-analytics",dangerouslySetInnerHTML:{__html:"\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', '".concat(i.In,"', {\n              page_path: window.location.pathname,\n            });\n          ")}})]}):null}},8947:function(e,t,n){"use strict";n.d(t,{ChakraWrapper:function(){return i}});var r=n(7437),a=n(5233),o=n(58);function i(e){let{children:t}=e,n=(0,a.F)({});return(0,r.jsx)(o.x,{value:n,children:t})}},9295:function(e,t,n){"use strict";var r=n(7437),a=n(2265),o=n(7648),i=n(9376),s=n(4362);t.default=()=>{let{user:e,logout:t}=(0,s.a)(),[n,c]=(0,a.useState)(!1),l=(0,i.usePathname)();return(0,r.jsx)("header",{className:"bg-blue-700 text-white p-4 shadow-md",children:(0,r.jsxs)("div",{className:"container mx-auto flex flex-wrap items-center justify-between",children:[(0,r.jsx)(o.default,{href:"/",className:"text-xl font-bold",children:"GTO Vantage"}),(0,r.jsx)("button",{className:"md:hidden p-2 text-white focus:outline-none",onClick:()=>c(!n),"aria-label":"メニュー",children:n?(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,r.jsx)("nav",{className:"w-full md:w-auto md:flex ".concat(n?"block":"hidden"," mt-4 md:mt-0"),children:(0,r.jsxs)("ul",{className:"flex flex-col md:flex-row md:items-center md:space-x-6",children:[(0,r.jsx)("li",{children:(0,r.jsx)(o.default,{href:"/",className:"block py-2 md:py-0 ".concat("/"===l?"font-bold":"hover:text-blue-200"),children:"ホーム"})}),e&&(0,r.jsx)("li",{children:(0,r.jsx)(o.default,{href:"/trainer/mtt",className:"block py-2 md:py-0 ".concat(l.startsWith("/trainer")?"font-bold":"hover:text-blue-200"),children:"GTOトレーナー"})}),e&&(0,r.jsx)("li",{children:(0,r.jsx)(o.default,{href:"/subscription",className:"block py-2 md:py-0 ".concat("/subscription"===l?"font-bold":"hover:text-blue-200"),children:"サブスクリプション"})}),e&&(0,r.jsx)("li",{children:(0,r.jsx)(o.default,{href:"/mypage",className:"block py-2 md:py-0 ".concat("/mypage"===l?"font-bold":"hover:text-blue-200"),children:"マイページ"})}),e?(0,r.jsx)("li",{className:"mt-4 md:mt-0 md:ml-6",children:(0,r.jsx)("button",{onClick:t,className:"block bg-transparent border border-white text-white px-4 py-1 rounded hover:bg-blue-600",children:"ログアウト"})}):(0,r.jsxs)("li",{className:"mt-4 md:mt-0 md:ml-6 flex flex-col md:flex-row",children:[(0,r.jsx)(o.default,{href:"/login",className:"block bg-transparent border border-white text-white px-4 py-1 rounded mb-2 md:mb-0 md:mr-2 text-center hover:bg-blue-600",children:"ログイン"}),(0,r.jsx)(o.default,{href:"/register",className:"block bg-white text-blue-700 px-4 py-1 rounded text-center hover:bg-gray-100",children:"新規登録"})]})]})})]})})}},7561:function(e,t,n){"use strict";n.d(t,{A:function(){return c},AdminProvider:function(){return s}});var r=n(7437),a=n(2265),o=n(4371);let i=(0,a.createContext)(void 0);function s(e){let{children:t}=e,[n,s]=(0,a.useState)(!1),[c,l]=(0,a.useState)(null),[u,d]=(0,a.useState)(null),[m,g]=(0,a.useState)(!0),h=async e=>{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4);try{let r=await fetch("/api/admin/auth",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json",Accept:"application/json","Cache-Control":"no-cache"},signal:t.signal});if(clearTimeout(n),!r.ok)return localStorage.removeItem("admin-token"),s(!1),l(null),d(null),!1;{let t=await r.json();return s(!0),l(t.user),d(e),!0}}catch(e){return clearTimeout(n),console.error("トークン検証エラー:",e),localStorage.removeItem("admin-token"),s(!1),l(null),d(null),!1}};(0,a.useEffect)(()=>{(async()=>{{let e=localStorage.getItem("admin-token");e&&await h(e)}g(!1)})()},[]);let p=async(e,t)=>{let n=new AbortController,r=setTimeout(()=>n.abort(),15e3);try{let a=await fetch("/api/admin/auth",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","Cache-Control":"no-cache"},body:JSON.stringify({username:e,password:t}),signal:n.signal});if(clearTimeout(r),a.ok){let e=await a.json();return s(!0),l(e.user),d(e.token),localStorage.setItem("admin-token",e.token),o.fW.login("admin"),!0}{let e=await a.json().catch(()=>({}));return console.warn("管理者ログイン失敗:",a.status,e),!1}}catch(e){return clearTimeout(r),e instanceof Error&&"AbortError"===e.name?console.error("管理者ログインタイムアウト"):console.error("管理者ログインエラー:",e),!1}};return(0,r.jsx)(i.Provider,{value:{isAdmin:n,user:c,token:u,login:p,logout:()=>{s(!1),l(null),d(null),localStorage.removeItem("admin-token")},loading:m},children:t})}function c(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAdmin must be used within an AdminProvider");return e}},4362:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return l},a:function(){return s}});var r=n(7437),a=n(2265),o=n(4371);let i=(0,a.createContext)(void 0),s=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},c=["admin@gtovantage.com","master@gtovantage.com"],l=e=>{let{children:t}=e,[n,s]=(0,a.useState)(null),[l,u]=(0,a.useState)(!0),[d,m]=(0,a.useState)(0);(0,a.useEffect)(()=>{{(()=>{try{let e=JSON.parse(localStorage.getItem("gto-vantage-users")||"[]"),t=!1;c.forEach(n=>{let r=e.find(e=>e.email===n);if(r){let e=btoa("GTO2024Admin!"+n);(["Acs@ef3UR","admin123","GTO2024Admin!"].includes(r.password)||r.password!==e)&&(r.password=e,r.isMasterUser=!0,r.subscriptionStatus="master",r.emailVerified=!0,t=!0,console.log("\uD83D\uDD04 マスターアカウントパスワード更新: ".concat(n)))}else{let r={id:"master-".concat(Date.now()),email:n,name:"admin@gtovantage.com"===n?"Admin":"Master",password:btoa("GTO2024Admin!"+n),createdAt:new Date().toISOString(),emailVerified:!0,isMasterUser:!0,subscriptionStatus:"master",practiceCount:0};e.push(r),t=!0,console.log("✅ マスターアカウント作成: ".concat(n))}}),t&&(localStorage.setItem("gto-vantage-users",JSON.stringify(e)),console.log("✅ マスターアカウントの確保が完了しました"))}catch(e){console.error("マスターアカウント確保エラー:",e)}})();let e=localStorage.getItem("gto-vantage-user");if(e)try{let t=JSON.parse(e);s(t)}catch(e){console.error("ユーザーデータの読み込みエラー:",e),localStorage.removeItem("gto-vantage-user")}let t=new Date().toDateString(),n=localStorage.getItem("practiceDate"),r=localStorage.getItem("practiceCount");n===t&&r?m(parseInt(r,10)):(m(0),localStorage.setItem("practiceDate",t),localStorage.setItem("practiceCount","0")),u(!1)}},[]);let g={user:n,isLoading:l,register:async(e,t,n)=>{try{let r=JSON.parse(localStorage.getItem("gto-vantage-users")||"[]");if(r.find(t=>t.email===e))throw Error("このメールアドレスは既に登録されています");let a={id:Date.now().toString(),email:e,name:n,createdAt:new Date().toISOString(),emailVerified:!1,isMasterUser:c.includes(e),subscriptionStatus:c.includes(e)?"master":"free",practiceCount:0},i=btoa(t+e);return r.push({...a,password:i}),localStorage.setItem("gto-vantage-users",JSON.stringify(r)),s(a),localStorage.setItem("gto-vantage-user",JSON.stringify(a)),o.fW.register(),!0}catch(e){return console.error("Registration failed:",e),!1}},login:async(e,t)=>{try{let n=JSON.parse(localStorage.getItem("gto-vantage-users")||"[]"),r=btoa(t+e),a=n.find(t=>t.email===e&&t.password===r);if(!a)throw Error("メールアドレスまたはパスワードが正しくありません");let i={...a};delete i.password,s(i),localStorage.setItem("gto-vantage-user",JSON.stringify(i));let c=i.isMasterUser?"master":"user";return o.fW.login(c),!0}catch(e){return console.error("Login failed:",e),!1}},logout:()=>{s(null),localStorage.removeItem("gto-vantage-user")},isAuthenticated:!!n,isEmailVerified:(null==n?void 0:n.emailVerified)||!1,isMasterUser:(null==n?void 0:n.isMasterUser)||!1,hasActiveSubscription:(null==n?void 0:n.subscriptionStatus)!=="free",canPractice:!!n,practiceCount:d,maxPracticeCount:(null==n?void 0:n.subscriptionStatus)==="master"?1/0:50,incrementPracticeCount:()=>{let e=d+1;m(e),localStorage.setItem("practiceCount",e.toString())},canUseStackSize:e=>!!n&&("master"===n.subscriptionStatus||"premium"===n.subscriptionStatus||("light"===n.subscriptionStatus?["10BB","15BB","20BB"].includes(e):"20BB"===e)),getAllowedStackSizes:()=>n?"master"===n.subscriptionStatus||"premium"===n.subscriptionStatus?["10BB","15BB","20BB","30BB","40BB","50BB","75BB"]:"light"===n.subscriptionStatus?["10BB","15BB","20BB"]:["20BB"]:["20BB"]};return(0,r.jsx)(i.Provider,{value:g,children:t})}},4371:function(e,t,n){"use strict";n.d(t,{In:function(){return r},Z0:function(){return o},_k:function(){return a},fW:function(){return s}});let r="G-HWHZWKBF4J",a=()=>{if(!r){console.warn("GA4 Measurement ID is not set");return}{let e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=".concat(r),document.head.appendChild(e),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",r,{page_title:document.title,page_location:window.location.href})}},o=(e,t)=>{r&&window.gtag("config",r,{page_path:e,page_title:t||document.title})},i=(e,t,n,a,o)=>{r&&window.gtag("event",e,{event_category:t,event_label:n,value:a,...o})},s={startTraining:(e,t,n)=>{i("start_training","training","".concat(e,"_").concat(t,"_").concat(n),void 0,{position:e,stack_size:t,action_type:n})},selectAction:(e,t,n)=>{i("select_action","training",e,t?1:0,{action:e,is_correct:t,position:n})},completeTraining:(e,t,n)=>{i("complete_training","training","session_complete",t,{correct_count:e,total_count:t,accuracy_percentage:Math.round(100*n)})},useCustomRange:(e,t,n)=>{i("use_custom_range","feature","".concat(e,"_").concat(t,"_").concat(n),void 0,{position:e,stack_size:t,action_type:n})},saveRange:(e,t,n,r)=>{i("save_range","feature","".concat(e,"_").concat(t,"_").concat(n),r,{position:e,stack_size:t,action_type:n,hand_count:r})},login:e=>{i("login","auth",e,void 0,{user_type:e})},register:()=>{i("sign_up","auth","user_registration")},viewSubscription:()=>{i("view_subscription","engagement","subscription_page")},trackError:(e,t,n)=>{i("error","system",e,void 0,{error_message:t,page:n})}}},2778:function(){}},function(e){e.O(0,[635,972,618,971,117,744],function(){return e(e.s=8575)}),_N_E=e.O()}]);