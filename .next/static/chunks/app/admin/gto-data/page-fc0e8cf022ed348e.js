(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[46],{4106:function(e,s,t){Promise.resolve().then(t.bind(t,753))},753:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return GTODataManagementPage}});var a=t(7437),l=t(2265),i=t(1396),c=t.n(i);function GTODataManagementPage(){let[e,s]=(0,l.useState)([]),[t,i]=(0,l.useState)(!1),[r,n]=(0,l.useState)(null),[d,x]=(0,l.useState)(!0);(0,l.useEffect)(()=>{fetchGTODataFiles()},[]);let fetchGTODataFiles=async()=>{x(!0);try{let e=await fetch("/api/gto/upload"),t=await e.json();t.files?s(t.files):s([])}catch(e){console.error("GTOデータの取得に失敗しました:",e)}finally{x(!1)}},handleFileUpload=async e=>{e.preventDefault();let s=e.target;if(!s.files||0===s.files.length)return;let t=s.files[0];if(!t.name.endsWith(".csv")&&!t.name.endsWith(".json")){n({success:!1,error:"対応していないファイル形式です。CSVまたはJSONファイルをアップロードしてください。"});return}let a=new FormData;a.append("file",t),i(!0),n(null);try{let e=await fetch("/api/gto/upload",{method:"POST",body:a}),s=await e.json();e.ok?(n({success:!0,message:"".concat(s.filename," を正常にアップロードしました。").concat(s.handCount,"個のハンドデータを含みます。")}),fetchGTODataFiles()):n({success:!1,error:s.error||"アップロードに失敗しました。"})}catch(e){n({success:!1,error:"サーバーとの通信に失敗しました。"})}finally{i(!1),s.value=""}};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white p-4 md:p-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"GTOデータ管理"}),(0,a.jsx)(c(),{href:"/trainer",className:"text-blue-400 hover:text-blue-300",children:"← トレーナーに戻る"})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"PioSolverデータのアップロード"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("p",{className:"text-gray-300 mb-4",children:"PioSolverからエクスポートしたCSVファイルまたはJSONファイルをアップロードしてください。 ファイル名は「ポジション_スタックサイズ_シナリオ.csv」の形式を推奨します（例: BTN_100BB_openraise.csv）。"}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[(0,a.jsxs)("label",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg cursor-pointer",children:["ファイルを選択",(0,a.jsx)("input",{type:"file",accept:".csv,.json",className:"hidden",onChange:handleFileUpload,disabled:t})]}),t&&(0,a.jsxs)("div",{className:"text-gray-300 flex items-center",children:[(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"アップロード中..."]})]}),r&&(0,a.jsx)("div",{className:"mt-4 p-3 rounded-lg ".concat(r.success?"bg-green-800":"bg-red-800"),children:r.success?r.message:r.error})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"対応フォーマット:"}),(0,a.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,a.jsx)("li",{children:"PioSolverのCSVエクスポート（ハンド毎のアクション頻度とEV）"}),(0,a.jsx)("li",{children:"標準的なGTOソルバーのJSONフォーマット"})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"利用可能なGTOデータ"}),d?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsxs)("svg",{className:"animate-spin h-8 w-8 mx-auto mb-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"データを読み込み中..."]}):0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-400",children:"GTOデータがありません。PioSolverのCSVファイルをアップロードしてください。"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full min-w-full divide-y divide-gray-700",children:[(0,a.jsx)("thead",{className:"bg-gray-700",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"ファイル名"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"ポジション"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"スタック"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"シナリオ"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"サイズ"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"更新日"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-700",children:e.map((e,s)=>(0,a.jsxs)("tr",{className:s%2==0?"bg-gray-800":"bg-gray-750",children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.filename}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.position||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.stackSize||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.scenario||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:formatFileSize(e.size)}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:formatDate(e.modified)})]},s))})]})})]})]})})}function formatFileSize(e){return e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB"}function formatDate(e){let s=new Date(e);return s.toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}}},function(e){e.O(0,[176,971,472,744],function(){return e(e.s=4106)}),_N_E=e.O()}]);