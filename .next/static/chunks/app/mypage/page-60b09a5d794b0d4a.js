(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[422],{3882:function(e,t,s){Promise.resolve().then(s.bind(s,329))},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},329:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(7437),r=s(4362),n=s(7648),l=s(2265),i=s(9376);function c(e){let{isOpen:t,onClose:s}=e,{user:n}=(0,r.a)(),[i,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[m,u]=(0,l.useState)(""),[x,h]=(0,l.useState)(!1),[g,b]=(0,l.useState)(""),[p,f]=(0,l.useState)(""),y=async e=>{if(e.preventDefault(),b(""),f(""),!i||!o||!m){b("全てのフィールドを入力してください");return}if(o.length<6){b("新しいパスワードは6文字以上である必要があります");return}if(o!==m){b("新しいパスワードと確認用パスワードが一致しません");return}if(!n){b("ユーザー情報が見つかりません");return}h(!0),setTimeout(()=>{f("パスワードが正常に変更されました"),c(""),d(""),u(""),h(!1),setTimeout(()=>{s(),f("")},2e3)},1e3)};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white",children:"パスワード変更"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"現在のパスワード"}),(0,a.jsx)("input",{type:"password",id:"currentPassword",value:i,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"現在のパスワードを入力"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"新しいパスワード"}),(0,a.jsx)("input",{type:"password",id:"newPassword",value:o,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"新しいパスワードを入力（6文字以上）"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"新しいパスワード（確認）"}),(0,a.jsx)("input",{type:"password",id:"confirmPassword",value:m,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"新しいパスワードを再入力"})]}),g&&(0,a.jsx)("div",{className:"bg-red-900 border border-red-700 text-red-200 px-3 py-2 rounded-md text-sm",children:g}),p&&(0,a.jsx)("div",{className:"bg-green-900 border border-green-700 text-green-200 px-3 py-2 rounded-md text-sm",children:p}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",disabled:x,children:"キャンセル"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:x,children:x?"変更中...":"パスワード変更"})]})]})]})}):null}function o(){var e;let{user:t,isEmailVerified:s,isMasterUser:o,hasActiveSubscription:d,practiceCount:m,maxPracticeCount:u}=(0,r.a)(),[x,h]=(0,l.useState)(!1),[g,b]=(0,l.useState)({totalQuestions:0,correctAnswers:0,incorrectAnswers:0,accuracyRate:0,monthlyStats:{practiceDays:0,totalPractice:0,averageAccuracy:0,consecutiveCorrect:0},monthlyAccuracy:[{month:"1月",rate:0,color:"bg-gray-500"},{month:"2月",rate:0,color:"bg-gray-500"},{month:"3月",rate:0,color:"bg-gray-500"},{month:"4月",rate:0,color:"bg-gray-500"},{month:"5月",rate:0,color:"bg-gray-500"},{month:"6月",rate:0,color:"bg-gray-500"},{month:"7月",rate:0,color:"bg-gray-500"},{month:"8月",rate:0,color:"bg-gray-500"}]}),p=(0,i.useRouter)(),f=()=>{try{let e=localStorage.getItem("trainingStats");if(e){let t=JSON.parse(e);b(t)}}catch(e){console.error("統計データの読み込みに失敗しました:",e)}};return((0,l.useEffect)(()=>{t?f():p.push("/")},[t,p]),t)?(0,a.jsxs)("div",{className:"min-h-screen py-8",children:[(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg shadow-sm p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-white",children:"マイページ"}),(0,a.jsx)("p",{className:"text-gray-300 mt-1",children:"アカウント情報と設定を管理"})]}),(0,a.jsx)("div",{className:"hidden sm:block",children:(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-xl font-bold",children:(null==t?void 0:null===(e=t.name)||void 0===e?void 0:e.charAt(0).toUpperCase())||"U"})})})]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"アカウント情報"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"ユーザー名"}),(0,a.jsx)("span",{className:"font-medium text-white",children:t.name})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"メールアドレス"}),(0,a.jsx)("span",{className:"font-medium text-white",children:t.email})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"登録日"}),(0,a.jsx)("span",{className:"font-medium text-white",children:t.createdAt?new Date(t.createdAt).toLocaleDateString("ja-JP"):"-"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"メール認証"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(s?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:s?"認証済み":"未認証"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"パスワード"}),(0,a.jsxs)("button",{onClick:()=>h(!0),className:"inline-flex items-center px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),"変更"]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"サブスクリプション"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"現在のプラン"}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("master"===t.subscriptionStatus?"bg-purple-100 text-purple-800":"premium"===t.subscriptionStatus?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:"master"===t.subscriptionStatus?"マスター":"premium"===t.subscriptionStatus?"プレミアム":"フリー"})]}),(0,a.jsx)("div",{className:"pt-4",children:(0,a.jsxs)(n.default,{href:"/subscription",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:["サブスクリプション管理",(0,a.jsx)("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"統計情報"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-3",children:"正解統計"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"総問題数"}),(0,a.jsx)("span",{className:"text-white font-semibold",children:g.totalQuestions>0?g.totalQuestions:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"正解数"}),(0,a.jsx)("span",{className:"text-green-400 font-semibold",children:g.correctAnswers>0?g.correctAnswers:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"不正解数"}),(0,a.jsx)("span",{className:"text-red-400 font-semibold",children:g.incorrectAnswers>0?g.incorrectAnswers:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"正解率"}),(0,a.jsx)("span",{className:"text-blue-400 font-semibold",children:g.accuracyRate>0?"".concat(g.accuracyRate,"%"):"--"})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-3",children:"今月の統計"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"練習日数"}),(0,a.jsx)("span",{className:"text-white font-semibold",children:g.monthlyStats.practiceDays>0?g.monthlyStats.practiceDays:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"総練習回数"}),(0,a.jsx)("span",{className:"text-green-400 font-semibold",children:g.monthlyStats.totalPractice>0?g.monthlyStats.totalPractice:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"平均正解率"}),(0,a.jsx)("span",{className:"text-blue-400 font-semibold",children:g.monthlyStats.averageAccuracy>0?"".concat(g.monthlyStats.averageAccuracy,"%"):"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"連続正解"}),(0,a.jsx)("span",{className:"text-purple-400 font-semibold",children:g.monthlyStats.consecutiveCorrect>0?g.monthlyStats.consecutiveCorrect:"--"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"月別正解率推移"}),(0,a.jsx)("div",{className:"space-y-3",children:g.monthlyAccuracy.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-gray-300 w-8 text-sm",children:e.month}),(0,a.jsx)("div",{className:"flex-1 bg-gray-600 rounded-full h-3",children:(0,a.jsx)("div",{className:"".concat(e.color," h-3 rounded-full transition-all duration-300"),style:{width:"".concat(e.rate,"%")}})}),(0,a.jsxs)("span",{className:"text-white font-semibold w-12 text-sm",children:[e.rate,"%"]})]},t))}),g.monthlyAccuracy.every(e=>0===e.rate)&&(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"データがありません。トレーニングを開始してデータを蓄積しましょう。"})})]})]})]})]}),(0,a.jsx)(c,{isOpen:x,onClose:()=>h(!1)})]}):null}},4362:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return c},a:function(){return l}});var a=s(7437),r=s(2265);let n=(0,r.createContext)(void 0),l=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},i=["admin@gtovantage.com","master@gtovantage.com"],c=e=>{let{children:t}=e,[s,l]=(0,r.useState)(null),[c,o]=(0,r.useState)(!0),[d,m]=(0,r.useState)(0);(0,r.useEffect)(()=>{{(()=>{try{let e=JSON.parse(localStorage.getItem("gto-vantage-users")||"[]"),t=!1;i.forEach(s=>{let a=e.find(e=>e.email===s);if(a){let e=btoa("GTO2024Admin!"+s);(["Acs@ef3UR","admin123","GTO2024Admin!"].includes(a.password)||a.password!==e)&&(a.password=e,a.isMasterUser=!0,a.subscriptionStatus="master",a.emailVerified=!0,t=!0,console.log("\uD83D\uDD04 マスターアカウントパスワード更新: ".concat(s)))}else{let a={id:"master-".concat(Date.now()),email:s,name:"admin@gtovantage.com"===s?"Admin":"Master",password:btoa("GTO2024Admin!"+s),createdAt:new Date().toISOString(),emailVerified:!0,isMasterUser:!0,subscriptionStatus:"master",practiceCount:0};e.push(a),t=!0,console.log("✅ マスターアカウント作成: ".concat(s))}}),t&&(localStorage.setItem("gto-vantage-users",JSON.stringify(e)),console.log("✅ マスターアカウントの確保が完了しました"))}catch(e){console.error("マスターアカウント確保エラー:",e)}})();let e=localStorage.getItem("gto-vantage-user");if(e)try{let t=JSON.parse(e);l(t)}catch(e){console.error("ユーザーデータの読み込みエラー:",e),localStorage.removeItem("gto-vantage-user")}let t=new Date().toDateString(),s=localStorage.getItem("practiceDate"),a=localStorage.getItem("practiceCount");s===t&&a?m(parseInt(a,10)):(m(0),localStorage.setItem("practiceDate",t),localStorage.setItem("practiceCount","0")),o(!1)}},[]);let u={user:s,isLoading:c,register:async(e,t,s)=>{try{let a=JSON.parse(localStorage.getItem("gto-vantage-users")||"[]");if(a.find(t=>t.email===e))throw Error("このメールアドレスは既に登録されています");let r={id:Date.now().toString(),email:e,name:s,createdAt:new Date().toISOString(),emailVerified:!1,isMasterUser:i.includes(e),subscriptionStatus:i.includes(e)?"master":"free",practiceCount:0},n=btoa(t+e);return a.push({...r,password:n}),localStorage.setItem("gto-vantage-users",JSON.stringify(a)),l(r),localStorage.setItem("gto-vantage-user",JSON.stringify(r)),!0}catch(e){return console.error("Registration failed:",e),!1}},login:async(e,t)=>{try{let s=JSON.parse(localStorage.getItem("gto-vantage-users")||"[]"),a=btoa(t+e),r=s.find(t=>t.email===e&&t.password===a);if(!r)throw Error("メールアドレスまたはパスワードが正しくありません");let n={...r};return delete n.password,l(n),localStorage.setItem("gto-vantage-user",JSON.stringify(n)),!0}catch(e){return console.error("Login failed:",e),!1}},logout:()=>{l(null),localStorage.removeItem("gto-vantage-user")},isAuthenticated:!!s,isEmailVerified:(null==s?void 0:s.emailVerified)||!1,isMasterUser:(null==s?void 0:s.isMasterUser)||!1,hasActiveSubscription:(null==s?void 0:s.subscriptionStatus)!=="free",canPractice:!!s,practiceCount:d,maxPracticeCount:(null==s?void 0:s.subscriptionStatus)==="master"?1/0:50,incrementPracticeCount:()=>{let e=d+1;m(e),localStorage.setItem("practiceCount",e.toString())},canUseStackSize:e=>!!s&&("master"===s.subscriptionStatus||"premium"===s.subscriptionStatus||("light"===s.subscriptionStatus?["10BB","15BB","20BB"].includes(e):"20BB"===e)),getAllowedStackSizes:()=>s?"master"===s.subscriptionStatus||"premium"===s.subscriptionStatus?["10BB","15BB","20BB","30BB","40BB","50BB","75BB"]:"light"===s.subscriptionStatus?["10BB","15BB","20BB"]:["20BB"]:["20BB"]};return(0,a.jsx)(n.Provider,{value:u,children:t})}}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=3882)}),_N_E=e.O()}]);