(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[422],{3882:function(e,t,s){Promise.resolve().then(s.bind(s,329))},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},329:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(7437),r=s(4362),n=s(7648),i=s(2265),c=s(9376);function l(e){let{isOpen:t,onClose:s}=e,{user:n}=(0,r.a)(),[c,l]=(0,i.useState)(""),[o,d]=(0,i.useState)(""),[u,m]=(0,i.useState)(""),[g,x]=(0,i.useState)(!1),[h,p]=(0,i.useState)(""),[b,f]=(0,i.useState)(""),y=async e=>{if(e.preventDefault(),p(""),f(""),!c||!o||!u){p("全てのフィールドを入力してください");return}if(o.length<6){p("新しいパスワードは6文字以上である必要があります");return}if(o!==u){p("新しいパスワードと確認用パスワードが一致しません");return}if(!n){p("ユーザー情報が見つかりません");return}x(!0),setTimeout(()=>{f("パスワードが正常に変更されました"),l(""),d(""),m(""),x(!1),setTimeout(()=>{s(),f("")},2e3)},1e3)};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white",children:"パスワード変更"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"現在のパスワード"}),(0,a.jsx)("input",{type:"password",id:"currentPassword",value:c,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"現在のパスワードを入力"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"新しいパスワード"}),(0,a.jsx)("input",{type:"password",id:"newPassword",value:o,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"新しいパスワードを入力（6文字以上）"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"新しいパスワード（確認）"}),(0,a.jsx)("input",{type:"password",id:"confirmPassword",value:u,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"新しいパスワードを再入力"})]}),h&&(0,a.jsx)("div",{className:"bg-red-900 border border-red-700 text-red-200 px-3 py-2 rounded-md text-sm",children:h}),b&&(0,a.jsx)("div",{className:"bg-green-900 border border-green-700 text-green-200 px-3 py-2 rounded-md text-sm",children:b}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",disabled:g,children:"キャンセル"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:g,children:g?"変更中...":"パスワード変更"})]})]})]})}):null}function o(){var e;let{user:t,isEmailVerified:s,isMasterUser:o,hasActiveSubscription:d,practiceCount:u,maxPracticeCount:m}=(0,r.a)(),[g,x]=(0,i.useState)(!1),[h,p]=(0,i.useState)({totalQuestions:0,correctAnswers:0,incorrectAnswers:0,accuracyRate:0,monthlyStats:{practiceDays:0,totalPractice:0,averageAccuracy:0,consecutiveCorrect:0},monthlyAccuracy:[{month:"1月",rate:0,color:"bg-gray-500"},{month:"2月",rate:0,color:"bg-gray-500"},{month:"3月",rate:0,color:"bg-gray-500"},{month:"4月",rate:0,color:"bg-gray-500"},{month:"5月",rate:0,color:"bg-gray-500"},{month:"6月",rate:0,color:"bg-gray-500"},{month:"7月",rate:0,color:"bg-gray-500"},{month:"8月",rate:0,color:"bg-gray-500"}]}),b=(0,c.useRouter)(),f=()=>{try{let e=localStorage.getItem("trainingStats");if(e){let t=JSON.parse(e);p(t)}}catch(e){console.error("統計データの読み込みに失敗しました:",e)}};return((0,i.useEffect)(()=>{t?f():b.push("/")},[t,b]),t)?(0,a.jsxs)("div",{className:"min-h-screen py-8",children:[(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg shadow-sm p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-white",children:"マイページ"}),(0,a.jsx)("p",{className:"text-gray-300 mt-1",children:"アカウント情報と設定を管理"})]}),(0,a.jsx)("div",{className:"hidden sm:block",children:(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-xl font-bold",children:(null==t?void 0:null===(e=t.name)||void 0===e?void 0:e.charAt(0).toUpperCase())||"U"})})})]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"アカウント情報"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"ユーザー名"}),(0,a.jsx)("span",{className:"font-medium text-white",children:t.name})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"メールアドレス"}),(0,a.jsx)("span",{className:"font-medium text-white",children:t.email})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"登録日"}),(0,a.jsx)("span",{className:"font-medium text-white",children:t.createdAt?new Date(t.createdAt).toLocaleDateString("ja-JP"):"-"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"メール認証"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(s?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:s?"認証済み":"未認証"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"パスワード"}),(0,a.jsxs)("button",{onClick:()=>x(!0),className:"inline-flex items-center px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),"変更"]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"サブスクリプション"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"現在のプラン"}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("master"===t.subscriptionStatus?"bg-purple-100 text-purple-800":"premium"===t.subscriptionStatus?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:"master"===t.subscriptionStatus?"マスター":"premium"===t.subscriptionStatus?"プレミアム":"フリー"})]}),(0,a.jsx)("div",{className:"pt-4",children:(0,a.jsxs)(n.default,{href:"/subscription",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:["サブスクリプション管理",(0,a.jsx)("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"統計情報"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-3",children:"正解統計"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"総問題数"}),(0,a.jsx)("span",{className:"text-white font-semibold",children:h.totalQuestions>0?h.totalQuestions:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"正解数"}),(0,a.jsx)("span",{className:"text-green-400 font-semibold",children:h.correctAnswers>0?h.correctAnswers:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"不正解数"}),(0,a.jsx)("span",{className:"text-red-400 font-semibold",children:h.incorrectAnswers>0?h.incorrectAnswers:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"正解率"}),(0,a.jsx)("span",{className:"text-blue-400 font-semibold",children:h.accuracyRate>0?"".concat(h.accuracyRate,"%"):"--"})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-3",children:"今月の統計"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"練習日数"}),(0,a.jsx)("span",{className:"text-white font-semibold",children:h.monthlyStats.practiceDays>0?h.monthlyStats.practiceDays:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"総練習回数"}),(0,a.jsx)("span",{className:"text-green-400 font-semibold",children:h.monthlyStats.totalPractice>0?h.monthlyStats.totalPractice:"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"平均正解率"}),(0,a.jsx)("span",{className:"text-blue-400 font-semibold",children:h.monthlyStats.averageAccuracy>0?"".concat(h.monthlyStats.averageAccuracy,"%"):"--"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"連続正解"}),(0,a.jsx)("span",{className:"text-purple-400 font-semibold",children:h.monthlyStats.consecutiveCorrect>0?h.monthlyStats.consecutiveCorrect:"--"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"月別正解率推移"}),(0,a.jsx)("div",{className:"space-y-3",children:h.monthlyAccuracy.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-gray-300 w-8 text-sm",children:e.month}),(0,a.jsx)("div",{className:"flex-1 bg-gray-600 rounded-full h-3",children:(0,a.jsx)("div",{className:"".concat(e.color," h-3 rounded-full transition-all duration-300"),style:{width:"".concat(e.rate,"%")}})}),(0,a.jsxs)("span",{className:"text-white font-semibold w-12 text-sm",children:[e.rate,"%"]})]},t))}),h.monthlyAccuracy.every(e=>0===e.rate)&&(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"データがありません。トレーニングを開始してデータを蓄積しましょう。"})})]})]})]})]}),(0,a.jsx)(l,{isOpen:g,onClose:()=>x(!1)})]}):null}},4362:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return o},a:function(){return c}});var a=s(7437),r=s(2265),n=s(4371);let i=(0,r.createContext)(void 0),c=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=["admin@gtovantage.com","master@gtovantage.com"],o=e=>{let{children:t}=e,[s,c]=(0,r.useState)(null),[o,d]=(0,r.useState)(!0),[u,m]=(0,r.useState)(0);(0,r.useEffect)(()=>{{(()=>{try{let e=JSON.parse(localStorage.getItem("gto-vantage-users")||"[]"),t=!1;l.forEach(s=>{let a=e.find(e=>e.email===s);if(a){let e=btoa("GTO2024Admin!"+s);(["Acs@ef3UR","admin123","GTO2024Admin!"].includes(a.password)||a.password!==e)&&(a.password=e,a.isMasterUser=!0,a.subscriptionStatus="master",a.emailVerified=!0,t=!0,console.log("\uD83D\uDD04 マスターアカウントパスワード更新: ".concat(s)))}else{let a={id:"master-".concat(Date.now()),email:s,name:"admin@gtovantage.com"===s?"Admin":"Master",password:btoa("GTO2024Admin!"+s),createdAt:new Date().toISOString(),emailVerified:!0,isMasterUser:!0,subscriptionStatus:"master",practiceCount:0};e.push(a),t=!0,console.log("✅ マスターアカウント作成: ".concat(s))}}),t&&(localStorage.setItem("gto-vantage-users",JSON.stringify(e)),console.log("✅ マスターアカウントの確保が完了しました"))}catch(e){console.error("マスターアカウント確保エラー:",e)}})();let e=localStorage.getItem("gto-vantage-user");if(e)try{let t=JSON.parse(e);c(t)}catch(e){console.error("ユーザーデータの読み込みエラー:",e),localStorage.removeItem("gto-vantage-user")}let t=new Date().toDateString(),s=localStorage.getItem("practiceDate"),a=localStorage.getItem("practiceCount");s===t&&a?m(parseInt(a,10)):(m(0),localStorage.setItem("practiceDate",t),localStorage.setItem("practiceCount","0")),d(!1)}},[]);let g={user:s,isLoading:o,register:async(e,t,s)=>{try{let a=JSON.parse(localStorage.getItem("gto-vantage-users")||"[]");if(a.find(t=>t.email===e))throw Error("このメールアドレスは既に登録されています");let r={id:Date.now().toString(),email:e,name:s,createdAt:new Date().toISOString(),emailVerified:!1,isMasterUser:l.includes(e),subscriptionStatus:l.includes(e)?"master":"free",practiceCount:0},i=btoa(t+e);return a.push({...r,password:i}),localStorage.setItem("gto-vantage-users",JSON.stringify(a)),c(r),localStorage.setItem("gto-vantage-user",JSON.stringify(r)),n.fW.register(),!0}catch(e){return console.error("Registration failed:",e),!1}},login:async(e,t)=>{try{let s=JSON.parse(localStorage.getItem("gto-vantage-users")||"[]"),a=btoa(t+e),r=s.find(t=>t.email===e&&t.password===a);if(!r)throw Error("メールアドレスまたはパスワードが正しくありません");let i={...r};delete i.password,c(i),localStorage.setItem("gto-vantage-user",JSON.stringify(i));let l=i.isMasterUser?"master":"user";return n.fW.login(l),!0}catch(e){return console.error("Login failed:",e),!1}},logout:()=>{c(null),localStorage.removeItem("gto-vantage-user")},isAuthenticated:!!s,isEmailVerified:(null==s?void 0:s.emailVerified)||!1,isMasterUser:(null==s?void 0:s.isMasterUser)||!1,hasActiveSubscription:(null==s?void 0:s.subscriptionStatus)!=="free",canPractice:!!s,practiceCount:u,maxPracticeCount:(null==s?void 0:s.subscriptionStatus)==="master"?1/0:50,incrementPracticeCount:()=>{let e=u+1;m(e),localStorage.setItem("practiceCount",e.toString())},canUseStackSize:e=>!!s&&("master"===s.subscriptionStatus||"premium"===s.subscriptionStatus||("light"===s.subscriptionStatus?["10BB","15BB","20BB"].includes(e):"20BB"===e)),getAllowedStackSizes:()=>s?"master"===s.subscriptionStatus||"premium"===s.subscriptionStatus?["10BB","15BB","20BB","30BB","40BB","50BB","75BB"]:"light"===s.subscriptionStatus?["10BB","15BB","20BB"]:["20BB"]:["20BB"]};return(0,a.jsx)(i.Provider,{value:g,children:t})}},4371:function(e,t,s){"use strict";s.d(t,{In:function(){return a},Z0:function(){return n},_k:function(){return r},fW:function(){return c}});let a="G-HWHZWKBF4J",r=()=>{if(!a){console.warn("GA4 Measurement ID is not set");return}{let e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=".concat(a),document.head.appendChild(e),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",a,{page_title:document.title,page_location:window.location.href})}},n=(e,t)=>{a&&window.gtag("config",a,{page_path:e,page_title:t||document.title})},i=(e,t,s,r,n)=>{a&&window.gtag("event",e,{event_category:t,event_label:s,value:r,...n})},c={startTraining:(e,t,s)=>{i("start_training","training","".concat(e,"_").concat(t,"_").concat(s),void 0,{position:e,stack_size:t,action_type:s})},selectAction:(e,t,s)=>{i("select_action","training",e,t?1:0,{action:e,is_correct:t,position:s})},completeTraining:(e,t,s)=>{i("complete_training","training","session_complete",t,{correct_count:e,total_count:t,accuracy_percentage:Math.round(100*s)})},useCustomRange:(e,t,s)=>{i("use_custom_range","feature","".concat(e,"_").concat(t,"_").concat(s),void 0,{position:e,stack_size:t,action_type:s})},saveRange:(e,t,s,a)=>{i("save_range","feature","".concat(e,"_").concat(t,"_").concat(s),a,{position:e,stack_size:t,action_type:s,hand_count:a})},login:e=>{i("login","auth",e,void 0,{user_type:e})},register:()=>{i("sign_up","auth","user_registration")},viewSubscription:()=>{i("view_subscription","engagement","subscription_page")},trackError:(e,t,s)=>{i("error","system",e,void 0,{error_message:t,page:s})}}}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=3882)}),_N_E=e.O()}]);